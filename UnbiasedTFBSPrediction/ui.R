
options(shiny.maxRequestSize = 200*1024^2, repos = BiocInstaller::biocinstallRepos())
getOption("repos")

## Install all packages needed if packages not installed!!!!
list.of.packages <- c("shiny", 
                      "shinycssloaders",
                      "shinydashboard", 
                      "gridExtra", 
                      "Gviz",  
                      "GenomicInteractions",
                      "GenomicAlignments",
                      "rtracklayer", 
                      "magrittr",
                      "parallel", 
                      "TxDb.Hsapiens.UCSC.hg19.knownGene",
                      "BSgenome.Hsapiens.UCSC.hg19",
                      "org.Hs.eg.db",
                      "TFBSTools",
                      "JASPAR2016", 
                      "seqLogo",
                      "limma",
                      "biomaRt",
                      "AnnotationHub",
                      "readr",
                      "dplyr",
                      "tidyr",
                      "readxl",
                      "tibble")

new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
## try http:// if https:// URLs are not supported
source("https://bioconductor.org/biocLite.R")
if(length(new.packages)) BiocInstaller::biocLite(new.packages, suppressUpdates = TRUE)
#################################
######Code that needs to be run once
#######################################

library(shiny)
library(shinycssloaders)
library(shinydashboard)
library(gridExtra)

dashboardPage(
  dashboardHeader(title = "motifOverlapR"),
  dashboardSidebar(disable = TRUE),
    
  
  dashboardBody(tabsetPanel(
    
  
    tabPanel("Computational Prediction Componment", 
           
             box(
               h4("Motif/TFBS Input"),
               checkboxInput("TypeInSequence", "Type In DNA Sequence", value =  FALSE),
                    conditionalPanel(
                      condition = "input.TypeInSequence == true",
                      textInput("CustomDNASequence", "Type in DNA Sequence", value = "TAATTA" )
                    ),
                    
                    checkboxInput("CustomTFMatrix", "Upload Custom TF Position Weight Matrix", value =  FALSE),
                    conditionalPanel(
                      condition = "input.CustomTFMatrix == true",
                      fileInput("JasparCustomMatrix", "Upload Custom Jaspar Formated Position Weight Matrix", multiple = FALSE)
                    ),
                    
                    checkboxInput("JasparDataBase", "Select Position Weight Matrix from Jaspar Database",value =  FALSE),
                    conditionalPanel(
                      condition = "input.JasparDataBase == true",
                      fluidRow(
                      column(4,selectizeInput(inputId= "TranscriptionFactorPWM", label = "Transcription Factor", choices = list("Arnt",
                                                                                                                       "Ahr::Arnt",
                                                                                                                       "br",
                                                                                                                       "br(var.2)",
                                                                                                                       "br(var.3)",
                                                                                                                       "br(var.4)",
                                                                                                                       "Cf2",
                                                                                                                       "usp",
                                                                                                                       "Ddit3::Cebpa",
                                                                                                                       "Dof2",
                                                                                                                       "Dof3",
                                                                                                                       "dl",
                                                                                                                       "dl(var.2)",
                                                                                                                       "NFIL3",
                                                                                                                       "Eip74EF",
                                                                                                                       "Mecom",
                                                                                                                       "FOXF2",
                                                                                                                       "FOXD1",
                                                                                                                       "Gam1",
                                                                                                                       "Gfi1",
                                                                                                                       "Foxq1",
                                                                                                                       "Foxd3",
                                                                                                                       "HMG-1",
                                                                                                                       "HMG-I/Y",
                                                                                                                       "hb",
                                                                                                                       "IRF2",
                                                                                                                       "MNB1A",
                                                                                                                       "myb.Ph3",
                                                                                                                       "MZF1",
                                                                                                                       "MZF1(var.2)",
                                                                                                                       "MAX::MYC",
                                                                                                                       "Nkx2-5",
                                                                                                                       "PBF",
                                                                                                                       "PPARG",
                                                                                                                       "Pax2",
                                                                                                                       "Pax6",
                                                                                                                       "PBX1",
                                                                                                                       "RORA",
                                                                                                                       "RORA(var.2)",
                                                                                                                       "RREB1",
                                                                                                                       "RXRA::VDR",
                                                                                                                       "SOX9",
                                                                                                                       "Sox17",
                                                                                                                       "SPIB",
                                                                                                                       "squamosa",
                                                                                                                       "SRY",
                                                                                                                       "Su(H)",
                                                                                                                       "sna",
                                                                                                                       "Sox5",
                                                                                                                       "MAFG::NFE2L1",
                                                                                                                       "TAL1::TCF3",
                                                                                                                       "Hand1::Tcf3",
                                                                                                                       "bZIP910",
                                                                                                                       "bZIP911",
                                                                                                                       "REL",
                                                                                                                       "RELA",
                                                                                                                       "TBP",
                                                                                                                       "HLTF",
                                                                                                                       "Spz1",
                                                                                                                       "NR1H2::RXRA",
                                                                                                                       "Znf423",
                                                                                                                       "Macho-1",
                                                                                                                       "NFIC::TLX1",
                                                                                                                       "id1",
                                                                                                                       "ARR10",
                                                                                                                       "abi4",
                                                                                                                       "Nobox",
                                                                                                                       "ovo",
                                                                                                                       "PEND",
                                                                                                                       "EmBP-1",
                                                                                                                       "TGA1A",
                                                                                                                       "ZNF354C",
                                                                                                                       "Lhx3",
                                                                                                                       "CTCF",
                                                                                                                       "Pou5f1::Sox2",
                                                                                                                       "EWSR1-FLI1",
                                                                                                                       "Gabpa",
                                                                                                                       "Klf4",
                                                                                                                       "REST",
                                                                                                                       "RUNX1",
                                                                                                                       "Foxa2",
                                                                                                                       "Pparg::Rxra",
                                                                                                                       "Arid3a",
                                                                                                                       "NFATC2",
                                                                                                                       "INSM1",
                                                                                                                       "HOXA5",
                                                                                                                       "RARA::RXRA",
                                                                                                                       "NR4A2",
                                                                                                                       "NFIC",
                                                                                                                       "PLAG1",
                                                                                                                       "Nr2e3",
                                                                                                                       "CREB1",
                                                                                                                       "FOS::JUN",
                                                                                                                       "Abd-B",
                                                                                                                       "Antp",
                                                                                                                       "Awh",
                                                                                                                       "B-H1",
                                                                                                                       "B-H2",
                                                                                                                       "C15",
                                                                                                                       "CG11085",
                                                                                                                       "CG11294",
                                                                                                                       "CG11617",
                                                                                                                       "Dbx",
                                                                                                                       "lms",
                                                                                                                       "CG15696-RA",
                                                                                                                       "CG18599",
                                                                                                                       "CG32105",
                                                                                                                       "CG32532",
                                                                                                                       "Vsx2",
                                                                                                                       "Vsx1",
                                                                                                                       "CG4328-RA",
                                                                                                                       "HHEX",
                                                                                                                       "CG9876",
                                                                                                                       "Deaf1",
                                                                                                                       "Dfd",
                                                                                                                       "Dll",
                                                                                                                       "Dr",
                                                                                                                       "E5",
                                                                                                                       "Gsc",
                                                                                                                       "HGTX",
                                                                                                                       "Hmx",
                                                                                                                       "schlank",
                                                                                                                       "Lim1",
                                                                                                                       "Lim3",
                                                                                                                       "NK7.1",
                                                                                                                       "OdsH",
                                                                                                                       "Optix",
                                                                                                                       "Pph13",
                                                                                                                       "Ptx1",
                                                                                                                       "Rx",
                                                                                                                       "Scr",
                                                                                                                       "Six4",
                                                                                                                       "Trl",
                                                                                                                       "abd-A",
                                                                                                                       "achi",
                                                                                                                       "al",
                                                                                                                       "ap",
                                                                                                                       "ara",
                                                                                                                       "bap",
                                                                                                                       "bcd",
                                                                                                                       "brk",
                                                                                                                       "bsh",
                                                                                                                       "btn",
                                                                                                                       "caup",
                                                                                                                       "ct",
                                                                                                                       "ems",
                                                                                                                       "en",
                                                                                                                       "eve",
                                                                                                                       "exd",
                                                                                                                       "exex",
                                                                                                                       "ftz",
                                                                                                                       "hbn",
                                                                                                                       "hth",
                                                                                                                       "ind",
                                                                                                                       "inv",
                                                                                                                       "lab",
                                                                                                                       "lbe",
                                                                                                                       "lbl",
                                                                                                                       "mirr",
                                                                                                                       "oc",
                                                                                                                       "onecut",
                                                                                                                       "otp",
                                                                                                                       "pb",
                                                                                                                       "prd",
                                                                                                                       "repo",
                                                                                                                       "ro",
                                                                                                                       "Bgb::run",
                                                                                                                       "sd",
                                                                                                                       "slbo",
                                                                                                                       "slou",
                                                                                                                       "so",
                                                                                                                       "tup",
                                                                                                                       "twi",
                                                                                                                       "unc-4",
                                                                                                                       "unpg",
                                                                                                                       "vis",
                                                                                                                       "vnd",
                                                                                                                       "vvl",
                                                                                                                       "z",
                                                                                                                       "zen",
                                                                                                                       "zen2",
                                                                                                                       "Ubx",
                                                                                                                       "ARNT::HIF1A",
                                                                                                                       "che-1",
                                                                                                                       "lin-14",
                                                                                                                       "mab-3",
                                                                                                                       "ceh-10::ttx-3",
                                                                                                                       "ceh-22",
                                                                                                                       "ABF1",
                                                                                                                       "ABF2",
                                                                                                                       "ACE2",
                                                                                                                       "ADR1",
                                                                                                                       "AFT1",
                                                                                                                       "AFT2",
                                                                                                                       "ARG80",
                                                                                                                       "ARG81",
                                                                                                                       "ARO80",
                                                                                                                       "ARR1",
                                                                                                                       "ASG1",
                                                                                                                       "ASH1",
                                                                                                                       "AZF1",
                                                                                                                       "BAS1",
                                                                                                                       "CAD1",
                                                                                                                       "CAT8",
                                                                                                                       "CBF1",
                                                                                                                       "CEP3",
                                                                                                                       "CHA4",
                                                                                                                       "CIN5",
                                                                                                                       "CRZ1",
                                                                                                                       "CST6",
                                                                                                                       "CUP2",
                                                                                                                       "CUP9",
                                                                                                                       "DAL80",
                                                                                                                       "DAL81",
                                                                                                                       "DAL82",
                                                                                                                       "ECM22",
                                                                                                                       "ECM23",
                                                                                                                       "EDS1",
                                                                                                                       "FHL1",
                                                                                                                       "FKH1",
                                                                                                                       "FKH2",
                                                                                                                       "FZF1",
                                                                                                                       "GAL4",
                                                                                                                       "GAT1",
                                                                                                                       "GAT3",
                                                                                                                       "GAT4",
                                                                                                                       "GCN4",
                                                                                                                       "GCR1",
                                                                                                                       "GCR2",
                                                                                                                       "GIS1",
                                                                                                                       "GLN3",
                                                                                                                       "GSM1",
                                                                                                                       "GZF3",
                                                                                                                       "HAC1",
                                                                                                                       "HAL9",
                                                                                                                       "HAP1",
                                                                                                                       "HAP2",
                                                                                                                       "HAP3",
                                                                                                                       "HAP5",
                                                                                                                       "HCM1",
                                                                                                                       "HMRA2",
                                                                                                                       "HSF1",
                                                                                                                       "IME1",
                                                                                                                       "INO2",
                                                                                                                       "INO4",
                                                                                                                       "IXR1",
                                                                                                                       "LEU3",
                                                                                                                       "LYS14",
                                                                                                                       "MAC1",
                                                                                                                       "HMRA1",
                                                                                                                       "MBP1",
                                                                                                                       "MBP1::SWI6",
                                                                                                                       "MCM1",
                                                                                                                       "MET28",
                                                                                                                       "MET31",
                                                                                                                       "MET32",
                                                                                                                       "MET4",
                                                                                                                       "MGA1",
                                                                                                                       "MIG1",
                                                                                                                       "MIG2",
                                                                                                                       "MIG3",
                                                                                                                       "MOT3",
                                                                                                                       "MSN2",
                                                                                                                       "MSN4",
                                                                                                                       "NDT80",
                                                                                                                       "NHP10",
                                                                                                                       "NHP6A",
                                                                                                                       "NHP6B",
                                                                                                                       "NRG1",
                                                                                                                       "OAF1",
                                                                                                                       "OPI1",
                                                                                                                       "TOD6",
                                                                                                                       "DOT6",
                                                                                                                       "PDR1",
                                                                                                                       "PDR3",
                                                                                                                       "PDR8",
                                                                                                                       "PHD1",
                                                                                                                       "PHO2",
                                                                                                                       "PHO4",
                                                                                                                       "PUT3",
                                                                                                                       "RAP1",
                                                                                                                       "RDR1",
                                                                                                                       "RDS1",
                                                                                                                       "RDS2",
                                                                                                                       "REB1",
                                                                                                                       "REI1",
                                                                                                                       "RFX1",
                                                                                                                       "RGM1",
                                                                                                                       "RGT1",
                                                                                                                       "RIM101",
                                                                                                                       "RLM1",
                                                                                                                       "RME1",
                                                                                                                       "ROX1",
                                                                                                                       "RPH1",
                                                                                                                       "RPN4",
                                                                                                                       "RSC3",
                                                                                                                       "RSC30",
                                                                                                                       "RTG3",
                                                                                                                       "SFL1",
                                                                                                                       "SFP1",
                                                                                                                       "MOT2",
                                                                                                                       "SIP4",
                                                                                                                       "SKN7",
                                                                                                                       "SKO1",
                                                                                                                       "SMP1",
                                                                                                                       "SNT2",
                                                                                                                       "SOK2",
                                                                                                                       "SPT15",
                                                                                                                       "SPT2",
                                                                                                                       "SPT23",
                                                                                                                       "SRD1",
                                                                                                                       "STB3",
                                                                                                                       "STB4",
                                                                                                                       "STB5",
                                                                                                                       "STE12",
                                                                                                                       "STP1",
                                                                                                                       "STP2",
                                                                                                                       "STP3",
                                                                                                                       "STP4",
                                                                                                                       "SUM1",
                                                                                                                       "SUT1",
                                                                                                                       "SUT2",
                                                                                                                       "SWI4",
                                                                                                                       "SWI5",
                                                                                                                       "TBF1",
                                                                                                                       "TBS1",
                                                                                                                       "TEA1",
                                                                                                                       "TEC1",
                                                                                                                       "THI2",
                                                                                                                       "TOS8",
                                                                                                                       "TYE7",
                                                                                                                       "UGA3",
                                                                                                                       "UPC2",
                                                                                                                       "UME6",
                                                                                                                       "USV1",
                                                                                                                       "XBP1",
                                                                                                                       "YAP1",
                                                                                                                       "YAP3",
                                                                                                                       "YAP5",
                                                                                                                       "YAP6",
                                                                                                                       "YAP7",
                                                                                                                       "ERT1",
                                                                                                                       "NSI1",
                                                                                                                       "URC2",
                                                                                                                       "YER130C",
                                                                                                                       "YER184C",
                                                                                                                       "YGR067C",
                                                                                                                       "YHP1",
                                                                                                                       "YKL222C",
                                                                                                                       "YLL054C",
                                                                                                                       "YLR278C",
                                                                                                                       "TDA9",
                                                                                                                       "YNR063W",
                                                                                                                       "YOX1",
                                                                                                                       "YPR013C",
                                                                                                                       "YPR015C",
                                                                                                                       "YPR022C",
                                                                                                                       "YPR196W",
                                                                                                                       "YRM1",
                                                                                                                       "YRR1",
                                                                                                                       "ZAP1",
                                                                                                                       "ZMS1",
                                                                                                                       "SOX10",
                                                                                                                       "btd",
                                                                                                                       "CG34031",
                                                                                                                       "D",
                                                                                                                       "fkh",
                                                                                                                       "gt",
                                                                                                                       "H2.0",
                                                                                                                       "h",
                                                                                                                       "hkb",
                                                                                                                       "kni",
                                                                                                                       "nub",
                                                                                                                       "odd",
                                                                                                                       "opa",
                                                                                                                       "PHDP",
                                                                                                                       "slp1",
                                                                                                                       "tll",
                                                                                                                       "ttk",
                                                                                                                       "Zfx",
                                                                                                                       "BATF::JUN",
                                                                                                                       "Bcl6",
                                                                                                                       "CDX2",
                                                                                                                       "Crx",
                                                                                                                       "DUX4",
                                                                                                                       "E2F4",
                                                                                                                       "E2F6",
                                                                                                                       "FOS",
                                                                                                                       "FOSL1",
                                                                                                                       "FOSL2",
                                                                                                                       "FOXH1",
                                                                                                                       "Foxo1",
                                                                                                                       "FOXP1",
                                                                                                                       "Gata4",
                                                                                                                       "Gfi1b",
                                                                                                                       "HNF4G",
                                                                                                                       "Hoxc9",
                                                                                                                       "JUN",
                                                                                                                       "JUN(var.2)",
                                                                                                                       "JUNB",
                                                                                                                       "JUND",
                                                                                                                       "JUND(var.2)",
                                                                                                                       "Klf1",
                                                                                                                       "Nr1h3::Rxra",
                                                                                                                       "MAFF",
                                                                                                                       "MAFK",
                                                                                                                       "MEF2C",
                                                                                                                       "Myod1",
                                                                                                                       "Myog",
                                                                                                                       "MAF::NFE2",
                                                                                                                       "NFYB",
                                                                                                                       "Nkx2-5(var.2)",
                                                                                                                       "NR2C2",
                                                                                                                       "Nr5a2",
                                                                                                                       "NRF1",
                                                                                                                       "POU2F2",
                                                                                                                       "PRDM1",
                                                                                                                       "Rfx1",
                                                                                                                       "SMAD2::SMAD3::SMAD4",
                                                                                                                       "Sox3",
                                                                                                                       "Sox6",
                                                                                                                       "SP2",
                                                                                                                       "STAT1::STAT2",
                                                                                                                       "Stat4",
                                                                                                                       "Stat5a::Stat5b",
                                                                                                                       "Stat6",
                                                                                                                       "Tcf12",
                                                                                                                       "TCF7L2",
                                                                                                                       "USF2",
                                                                                                                       "ZBTB33",
                                                                                                                       "ZNF263",
                                                                                                                       "CEBPA",
                                                                                                                       "EGR1",
                                                                                                                       "ELK4",
                                                                                                                       "ESR2",
                                                                                                                       "FOXA1",
                                                                                                                       "Gata1",
                                                                                                                       "GATA2",
                                                                                                                       "GATA3",
                                                                                                                       "IRF1",
                                                                                                                       "Myb",
                                                                                                                       "Myc",
                                                                                                                       "Mycn",
                                                                                                                       "Nfe2l2",
                                                                                                                       "NFYA",
                                                                                                                       "PAX5",
                                                                                                                       "Sox2",
                                                                                                                       "SP1",
                                                                                                                       "STAT1",
                                                                                                                       "STAT3",
                                                                                                                       "GATA1::TAL1",
                                                                                                                       "USF1",
                                                                                                                       "YY1",
                                                                                                                       "ZEB1",
                                                                                                                       "BEAF-32",
                                                                                                                       "cad",
                                                                                                                       "cnc::maf-S",
                                                                                                                       "CTCF",
                                                                                                                       "Kr",
                                                                                                                       "Stat92E",
                                                                                                                       "su(Hw)",
                                                                                                                       "EcR::usp",
                                                                                                                       "pan",
                                                                                                                       "Mad",
                                                                                                                       "pnr",
                                                                                                                       "tin",
                                                                                                                       "blmp-1",
                                                                                                                       "daf-12",
                                                                                                                       "dpy-27",
                                                                                                                       "efl-1",
                                                                                                                       "elt-3",
                                                                                                                       "eor-1",
                                                                                                                       "snpc-4",
                                                                                                                       "hlh-1",
                                                                                                                       "pha-4",
                                                                                                                       "skn-1",
                                                                                                                       "AGL15",
                                                                                                                       "BZR2",
                                                                                                                       "BZR1",
                                                                                                                       "HY5",
                                                                                                                       "PIF1",
                                                                                                                       "SMZ",
                                                                                                                       "SOC1",
                                                                                                                       "SVP",
                                                                                                                       "AP3",
                                                                                                                       "FHY3",
                                                                                                                       "FLC",
                                                                                                                       "PI",
                                                                                                                       "PIF3",
                                                                                                                       "PIF4",
                                                                                                                       "PIF5",
                                                                                                                       "SEP3",
                                                                                                                       "ABI3",
                                                                                                                       "FUS3",
                                                                                                                       "MYC2",
                                                                                                                       "ERF1B",
                                                                                                                       "MYC3",
                                                                                                                       "MYC4",
                                                                                                                       "ABF1",
                                                                                                                       "AG",
                                                                                                                       "ANT",
                                                                                                                       "HAT5",
                                                                                                                       "ATHB-5",
                                                                                                                       "ATHB-9",
                                                                                                                       "MYB15",
                                                                                                                       "F3A4.140",
                                                                                                                       "RAX3",
                                                                                                                       "SPL3",
                                                                                                                       "SPL8",
                                                                                                                       "CDC5",
                                                                                                                       "DYT1",
                                                                                                                       "LEC2",
                                                                                                                       "RAV1",
                                                                                                                       "RAV1(var.2)",
                                                                                                                       "SEP1",
                                                                                                                       "AGL3",
                                                                                                                       "AGL1",
                                                                                                                       "SPL14",
                                                                                                                       "TCP16",
                                                                                                                       "TGA1",
                                                                                                                       "ZAP1",
                                                                                                                       "LFY",
                                                                                                                       "Bach1::Mafk",
                                                                                                                       "FOXP2",
                                                                                                                       "Hoxa9",
                                                                                                                       "SREBF1",
                                                                                                                       "SREBF2",
                                                                                                                       "THAP1",
                                                                                                                       "KLF5",
                                                                                                                       "Arid3b",
                                                                                                                       "Arid5a",
                                                                                                                       "Arntl",
                                                                                                                       "Atf1",
                                                                                                                       "Atf3",
                                                                                                                       "NFAT5",
                                                                                                                       "Bhlha15",
                                                                                                                       "Creb3l2",
                                                                                                                       "Crem",
                                                                                                                       "DMRT3",
                                                                                                                       "Dux",
                                                                                                                       "EMX1",
                                                                                                                       "FOXG1",
                                                                                                                       "Foxj2",
                                                                                                                       "Gmeb1",
                                                                                                                       "Hes1",
                                                                                                                       "Hes2",
                                                                                                                       "Id2",
                                                                                                                       "LBX1",
                                                                                                                       "LIN54",
                                                                                                                       "Mitf",
                                                                                                                       "mix-a",
                                                                                                                       "Mlxip",
                                                                                                                       "Neurog1",
                                                                                                                       "NFATC1",
                                                                                                                       "NFATC3",
                                                                                                                       "Npas2",
                                                                                                                       "Pou2f3",
                                                                                                                       "POU6F1",
                                                                                                                       "Rhox11",
                                                                                                                       "SHOX",
                                                                                                                       "Six3",
                                                                                                                       "Tcfl5",
                                                                                                                       "Twist2",
                                                                                                                       "ALX3",
                                                                                                                       "Ar",
                                                                                                                       "BARHL2",
                                                                                                                       "BHLHE41",
                                                                                                                       "CENPB",
                                                                                                                       "CREB3",
                                                                                                                       "DBP",
                                                                                                                       "EBF1",
                                                                                                                       "EHF",
                                                                                                                       "ELF3",
                                                                                                                       "ELF4",
                                                                                                                       "ELF5",
                                                                                                                       "EN1",
                                                                                                                       "EN2",
                                                                                                                       "Esrrg",
                                                                                                                       "ESX1",
                                                                                                                       "ETV6",
                                                                                                                       "FLI1",
                                                                                                                       "FOXI1",
                                                                                                                       "FOXL1",
                                                                                                                       "FOXO3",
                                                                                                                       "GCM1",
                                                                                                                       "GRHL1",
                                                                                                                       "GSC",
                                                                                                                       "HEY2",
                                                                                                                       "HINFP",
                                                                                                                       "HLF",
                                                                                                                       "HNF1A",
                                                                                                                       "HNF1B",
                                                                                                                       "HOXA13",
                                                                                                                       "HOXC11",
                                                                                                                       "HSF1",
                                                                                                                       "IRF8",
                                                                                                                       "IRF9",
                                                                                                                       "ISX",
                                                                                                                       "JDP2",
                                                                                                                       "JDP2(var.2)",
                                                                                                                       "KLF13",
                                                                                                                       "LHX6",
                                                                                                                       "MAFG",
                                                                                                                       "MEF2B",
                                                                                                                       "MEOX1",
                                                                                                                       "MIXL1",
                                                                                                                       "MLX",
                                                                                                                       "MLXIPL",
                                                                                                                       "MSC",
                                                                                                                       "MSX1",
                                                                                                                       "MYF6",
                                                                                                                       "NEUROD2",
                                                                                                                       "NEUROG2",
                                                                                                                       "NFIA",
                                                                                                                       "NFIX",
                                                                                                                       "NHLH1",
                                                                                                                       "NKX2-3",
                                                                                                                       "NKX2-8",
                                                                                                                       "NKX6-1",
                                                                                                                       "NKX6-2",
                                                                                                                       "Nr2e1",
                                                                                                                       "Nr2f6",
                                                                                                                       "OLIG2",
                                                                                                                       "ONECUT1",
                                                                                                                       "PAX4",
                                                                                                                       "PAX7",
                                                                                                                       "Phox2b",
                                                                                                                       "Pitx1",
                                                                                                                       "POU4F2",
                                                                                                                       "Prrx2",
                                                                                                                       "RUNX3",
                                                                                                                       "Rxra",
                                                                                                                       "SP4",
                                                                                                                       "SPDEF",
                                                                                                                       "SPI1",
                                                                                                                       "SPIC",
                                                                                                                       "SRF",
                                                                                                                       "T",
                                                                                                                       "TBX2",
                                                                                                                       "TBX20",
                                                                                                                       "TBX21",
                                                                                                                       "TEAD1",
                                                                                                                       "TFAP4",
                                                                                                                       "TFCP2",
                                                                                                                       "TFEB",
                                                                                                                       "Vdr",
                                                                                                                       "ZBTB7B",
                                                                                                                       "ZBTB7C",
                                                                                                                       "ZIC1",
                                                                                                                       "ZIC3",
                                                                                                                       "ZBTB18",
                                                                                                                       "LBX2",
                                                                                                                       "LHX2",
                                                                                                                       "LHX9",
                                                                                                                       "LMX1A",
                                                                                                                       "LMX1B",
                                                                                                                       "Lhx4",
                                                                                                                       "Lhx8",
                                                                                                                       "MEOX2",
                                                                                                                       "MNX1",
                                                                                                                       "MSX2",
                                                                                                                       "Msx3",
                                                                                                                       "NKX3-2",
                                                                                                                       "NOTO",
                                                                                                                       "Nkx3-1",
                                                                                                                       "OTX1",
                                                                                                                       "OTX2",
                                                                                                                       "PDX1",
                                                                                                                       "PHOX2A",
                                                                                                                       "PITX3",
                                                                                                                       "PROP1",
                                                                                                                       "PRRX1",
                                                                                                                       "RAX2",
                                                                                                                       "RAX",
                                                                                                                       "RHOXF1",
                                                                                                                       "Shox2",
                                                                                                                       "UNCX",
                                                                                                                       "VAX1",
                                                                                                                       "VAX2",
                                                                                                                       "VENTX",
                                                                                                                       "VSX1",
                                                                                                                       "VSX2",
                                                                                                                       "ESR1",
                                                                                                                       "ESRRB",
                                                                                                                       "Esrra",
                                                                                                                       "Hnf4a",
                                                                                                                       "NR2F1",
                                                                                                                       "NR3C1",
                                                                                                                       "NR3C2",
                                                                                                                       "Nr2f6(var.2)",
                                                                                                                       "RARA",
                                                                                                                       "RARA(var.2)",
                                                                                                                       "BCL6B",
                                                                                                                       "EGR2",
                                                                                                                       "EGR3",
                                                                                                                       "EGR4",
                                                                                                                       "GLI2",
                                                                                                                       "GLIS1",
                                                                                                                       "GLIS2",
                                                                                                                       "GLIS3",
                                                                                                                       "HIC2",
                                                                                                                       "Hic1",
                                                                                                                       "KLF14",
                                                                                                                       "KLF16",
                                                                                                                       "Klf12",
                                                                                                                       "SCRT1",
                                                                                                                       "SCRT2",
                                                                                                                       "SNAI2",
                                                                                                                       "SP3",
                                                                                                                       "SP8",
                                                                                                                       "YY2",
                                                                                                                       "ZBED1",
                                                                                                                       "ZBTB7A",
                                                                                                                       "ZIC4",
                                                                                                                       "ZNF143",
                                                                                                                       "ZNF410",
                                                                                                                       "ZNF740",
                                                                                                                       "CUX1",
                                                                                                                       "CUX2",
                                                                                                                       "ONECUT2",
                                                                                                                       "ONECUT3",
                                                                                                                       "E2F3",
                                                                                                                       "E2F7",
                                                                                                                       "ELF1",
                                                                                                                       "ELK3",
                                                                                                                       "ERF",
                                                                                                                       "ERG",
                                                                                                                       "ETS1",
                                                                                                                       "ETV1",
                                                                                                                       "ETV2",
                                                                                                                       "ETV3",
                                                                                                                       "ETV4",
                                                                                                                       "ETV5",
                                                                                                                       "FEV",
                                                                                                                       "GATA5",
                                                                                                                       "GCM2",
                                                                                                                       "LEF1",
                                                                                                                       "Tcf7",
                                                                                                                       "HSF2",
                                                                                                                       "HSF4",
                                                                                                                       "IRF7",
                                                                                                                       "MEF2A",
                                                                                                                       "MEF2D",
                                                                                                                       "MEIS1",
                                                                                                                       "MEIS2",
                                                                                                                       "MEIS3",
                                                                                                                       "MYBL1",
                                                                                                                       "MYBL2",
                                                                                                                       "NFKB1",
                                                                                                                       "NFKB2",
                                                                                                                       "PAX1",
                                                                                                                       "PAX3",
                                                                                                                       "PAX9",
                                                                                                                       "PKNOX1",
                                                                                                                       "PKNOX2",
                                                                                                                       "POU1F1",
                                                                                                                       "POU2F1",
                                                                                                                       "POU3F1",
                                                                                                                       "POU3F2",
                                                                                                                       "POU3F3",
                                                                                                                       "POU3F4",
                                                                                                                       "POU4F1",
                                                                                                                       "POU4F3",
                                                                                                                       "POU5F1B",
                                                                                                                       "POU6F2",
                                                                                                                       "PROX1",
                                                                                                                       "RFX2",
                                                                                                                       "SMAD3",
                                                                                                                       "TGIF1",
                                                                                                                       "TGIF2",
                                                                                                                       "RFX3",
                                                                                                                       "RFX4",
                                                                                                                       "RFX5",
                                                                                                                       "RUNX2",
                                                                                                                       "EOMES",
                                                                                                                       "MGA",
                                                                                                                       "TBR1",
                                                                                                                       "TBX15",
                                                                                                                       "TBX19",
                                                                                                                       "TBX1",
                                                                                                                       "TBX4",
                                                                                                                       "TBX5",
                                                                                                                       "TEAD3",
                                                                                                                       "TEAD4",
                                                                                                                       "TFAP2A(var.2)",
                                                                                                                       "TFAP2A",
                                                                                                                       "TFAP2B",
                                                                                                                       "TFAP2B(var.2)",
                                                                                                                       "TFAP2B(var.3)",
                                                                                                                       "TFAP2C",
                                                                                                                       "TFAP2C(var.2)",
                                                                                                                       "TFAP2C(var.3)",
                                                                                                                       "Ascl2",
                                                                                                                       "Atoh1",
                                                                                                                       "BHLHE40",
                                                                                                                       "BHLHE23",
                                                                                                                       "BHLHE22",
                                                                                                                       "CLOCK",
                                                                                                                       "FIGLA",
                                                                                                                       "HES5",
                                                                                                                       "HES7",
                                                                                                                       "HEY1",
                                                                                                                       "ID4",
                                                                                                                       "MAX",
                                                                                                                       "MNT",
                                                                                                                       "OLIG1",
                                                                                                                       "OLIG3",
                                                                                                                       "SREBF2(var.2)",
                                                                                                                       "Srebf1(var.2)",
                                                                                                                       "TCF3",
                                                                                                                       "TCF4",
                                                                                                                       "TFE3",
                                                                                                                       "Tcf21",
                                                                                                                       "ATF4",
                                                                                                                       "ATF7",
                                                                                                                       "BATF3",
                                                                                                                       "CEBPB",
                                                                                                                       "CEBPD",
                                                                                                                       "CEBPE",
                                                                                                                       "CEBPG",
                                                                                                                       "CREB3L1",
                                                                                                                       "Creb5",
                                                                                                                       "Mafb",
                                                                                                                       "NFE2",
                                                                                                                       "NRL",
                                                                                                                       "TEF",
                                                                                                                       "XBP1",
                                                                                                                       "FOXB1",
                                                                                                                       "FOXC1",
                                                                                                                       "FOXC2",
                                                                                                                       "FOXD2",
                                                                                                                       "FOXO4",
                                                                                                                       "FOXO6",
                                                                                                                       "FOXP3",
                                                                                                                       "Foxj3",
                                                                                                                       "Foxk1",
                                                                                                                       "Alx4",
                                                                                                                       "Alx1",
                                                                                                                       "RXRB",
                                                                                                                       "RXRG",
                                                                                                                       "Rarb",
                                                                                                                       "Rarb(var.2)",
                                                                                                                       "Rarg",
                                                                                                                       "Rarg(var.2)",
                                                                                                                       "TP63",
                                                                                                                       "TP53",
                                                                                                                       "TP73",
                                                                                                                       "GMEB2",
                                                                                                                       "MTF1",
                                                                                                                       "E2F1",
                                                                                                                       "E2F2",
                                                                                                                       "E2F8",
                                                                                                                       "SOX21",
                                                                                                                       "SOX4",
                                                                                                                       "SOX8",
                                                                                                                       "Sox11",
                                                                                                                       "Sox1",
                                                                                                                       "TFEC",
                                                                                                                       "TFAP2A(var.3)",
                                                                                                                       "ELK1",
                                                                                                                       "HOXD12",
                                                                                                                       "Arx",
                                                                                                                       "BARX1",
                                                                                                                       "BSX",
                                                                                                                       "Barhl1",
                                                                                                                       "CDX1",
                                                                                                                       "Dlx1",
                                                                                                                       "Dlx3",
                                                                                                                       "Dlx4",
                                                                                                                       "DLX6",
                                                                                                                       "Dmbx1",
                                                                                                                       "DUXA",
                                                                                                                       "Dlx2",
                                                                                                                       "EMX2",
                                                                                                                       "EVX1",
                                                                                                                       "EVX2",
                                                                                                                       "GBX1",
                                                                                                                       "GBX2",
                                                                                                                       "GSC2",
                                                                                                                       "GSX1",
                                                                                                                       "GSX2",
                                                                                                                       "HESX1",
                                                                                                                       "HMBOX1",
                                                                                                                       "Hmx1",
                                                                                                                       "Hmx2",
                                                                                                                       "Hmx3",
                                                                                                                       "HOXA10",
                                                                                                                       "HOXA2",
                                                                                                                       "HOXB13",
                                                                                                                       "HOXB2",
                                                                                                                       "HOXB3",
                                                                                                                       "Hoxb5",
                                                                                                                       "HOXC10",
                                                                                                                       "HOXC12",
                                                                                                                       "HOXC13",
                                                                                                                       "HOXD11",
                                                                                                                       "HOXD13",
                                                                                                                       "Hoxd8",
                                                                                                                       "Hoxa11",
                                                                                                                       "Hoxd3",
                                                                                                                       "Hoxd9",
                                                                                                                       "ISL2",
                                                                                                                       "dve",
                                                                                                                       "Ets21C",
                                                                                                                       "gcm2",
                                                                                                                       "unc-62",
                                                                                                                       "dsc-1",
                                                                                                                       "fkh-2",
                                                                                                                       "ceh-48",
                                                                                                                       "ces-2",
                                                                                                                       "lim-4",
                                                                                                                       "pal-1",
                                                                                                                       "sma-4",
                                                                                                                       "unc-86",
                                                                                                                       "vab-7",
                                                                                                                       "zfh-2",
                                                                                                                       "MATALPHA2",
                                                                                                                       "NCU00019",
                                                                                                                       "ABF3",
                                                                                                                       "ABI5",
                                                                                                                       "AHL12",
                                                                                                                       "AHL20",
                                                                                                                       "AHL25",
                                                                                                                       "NAC025",
                                                                                                                       "T11I18.17",
                                                                                                                       "NAC055",
                                                                                                                       "NAC058",
                                                                                                                       "NAC080",
                                                                                                                       "AP1",
                                                                                                                       "ABF2",
                                                                                                                       "ARF1",
                                                                                                                       "ARF5",
                                                                                                                       "ARF8",
                                                                                                                       "ARR1",
                                                                                                                       "ARR11",
                                                                                                                       "ARR14",
                                                                                                                       "ARR18",
                                                                                                                       "ARR2",
                                                                                                                       "ATHB-12",
                                                                                                                       "ATHB-16",
                                                                                                                       "ATHB-51",
                                                                                                                       "ATHB-6",
                                                                                                                       "ATHB-7",
                                                                                                                       "POPTR_0002s00440g",
                                                                                                                       "BEE2",
                                                                                                                       "BHLH3",
                                                                                                                       "BHLH13",
                                                                                                                       "AIB",
                                                                                                                       "BHLH104",
                                                                                                                       "BHLH112",
                                                                                                                       "BHLH34",
                                                                                                                       "BHLH78",
                                                                                                                       "BIM1",
                                                                                                                       "BIM2",
                                                                                                                       "BIM3",
                                                                                                                       "BZIP60",
                                                                                                                       "bZIP68",
                                                                                                                       "CMTA2",
                                                                                                                       "CMTA3",
                                                                                                                       "DREB1A",
                                                                                                                       "CCA1",
                                                                                                                       "CDF2",
                                                                                                                       "CDF3",
                                                                                                                       "CRF2",
                                                                                                                       "CRF4",
                                                                                                                       "DOF2.5",
                                                                                                                       "DREB1E",
                                                                                                                       "ERF008",
                                                                                                                       "RAP2-10",
                                                                                                                       "DOF1.8",
                                                                                                                       "DOF2.4",
                                                                                                                       "DOF5.6",
                                                                                                                       "DOF5.7",
                                                                                                                       "DRE1C",
                                                                                                                       "DREB2C",
                                                                                                                       "PHYPADRAFT_140773",
                                                                                                                       "PHYPADRAFT_143875",
                                                                                                                       "PHYPADRAFT_153324",
                                                                                                                       "EDT1",
                                                                                                                       "ERF4",
                                                                                                                       "ERF7",
                                                                                                                       "ERF8",
                                                                                                                       "ERF039",
                                                                                                                       "ERF043",
                                                                                                                       "ERF069",
                                                                                                                       "ERF096",
                                                                                                                       "ERF098",
                                                                                                                       "ERF105",
                                                                                                                       "ERF11",
                                                                                                                       "ERF112",
                                                                                                                       "ERF13",
                                                                                                                       "ERF3",
                                                                                                                       "ERF6",
                                                                                                                       "PHYPADRAFT_173530",
                                                                                                                       "PHYPADRAFT_182268",
                                                                                                                       "ARF3",
                                                                                                                       "PHYPADRAFT_64121",
                                                                                                                       "PHYPADRAFT_72483",
                                                                                                                       "AGL27",
                                                                                                                       "GATA10",
                                                                                                                       "GATA11",
                                                                                                                       "GATA12",
                                                                                                                       "GATA15",
                                                                                                                       "GATA8",
                                                                                                                       "GATA9",
                                                                                                                       "Glyma19g26560.1",
                                                                                                                       "GT-1",
                                                                                                                       "PHYPADRAFT_48267",
                                                                                                                       "PHYPADRAFT_38837",
                                                                                                                       "PHYPADRAFT_28324",
                                                                                                                       "HAT1",
                                                                                                                       "HBI1",
                                                                                                                       "ATHB-15",
                                                                                                                       "KAN1",
                                                                                                                       "KAN4",
                                                                                                                       "P0510F09.23",
                                                                                                                       "OJ1581_H09.2",
                                                                                                                       "DREB1G",
                                                                                                                       "OJ1058_F05.8",
                                                                                                                       "Os05g0497200",
                                                                                                                       "TCP4",
                                                                                                                       "MYB111",
                                                                                                                       "MYB24",
                                                                                                                       "MYB3",
                                                                                                                       "MYB4",
                                                                                                                       "MYB46",
                                                                                                                       "MYB55",
                                                                                                                       "MYB59",
                                                                                                                       "NAC083",
                                                                                                                       "NAC92",
                                                                                                                       "NAC043",
                                                                                                                       "NTL9",
                                                                                                                       "TGA5",
                                                                                                                       "ERF018",
                                                                                                                       "ERF094",
                                                                                                                       "OsI_08196",
                                                                                                                       "RAP2-3",
                                                                                                                       "RAP2-6",
                                                                                                                       "ERF109",
                                                                                                                       "ARALYDRAFT_897773",
                                                                                                                       "SPL1",
                                                                                                                       "SPL11",
                                                                                                                       "SPL12",
                                                                                                                       "SPL4",
                                                                                                                       "SPL5",
                                                                                                                       "SPL7",
                                                                                                                       "SPT",
                                                                                                                       "TCP15",
                                                                                                                       "TCP19",
                                                                                                                       "TCP2",
                                                                                                                       "TCP20",
                                                                                                                       "TCP23",
                                                                                                                       "TCP5",
                                                                                                                       "TGA2",
                                                                                                                       "TGA6",
                                                                                                                       "TGA7",
                                                                                                                       "DOF5.3",
                                                                                                                       "TRB2",
                                                                                                                       "UNE10",
                                                                                                                       "WRKY12",
                                                                                                                       "WRKY15",
                                                                                                                       "WRKY18",
                                                                                                                       "WRKY2",
                                                                                                                       "WRKY21",
                                                                                                                       "WRKY23",
                                                                                                                       "WRKY25",
                                                                                                                       "WRKY30",
                                                                                                                       "WRKY38",
                                                                                                                       "WRKY40",
                                                                                                                       "WRKY43",
                                                                                                                       "WRKY45",
                                                                                                                       "WRKY48",
                                                                                                                       "WRKY57",
                                                                                                                       "WRKY60",
                                                                                                                       "WRKY62",
                                                                                                                       "WRKY63",
                                                                                                                       "WRKY75",
                                                                                                                       "WRKY8",
                                                                                                                       "ARALYDRAFT_495258",
                                                                                                                       "ARALYDRAFT_496250",
                                                                                                                       "ARALYDRAFT_493022",
                                                                                                                       "ARALYDRAFT_484486"), selected = "Arx")),
                      column(4, numericInput(inputId= "MatchPercentage", label = "% Match of motif", value = 90, min = 0, max= 100)))),
               
                    
               checkboxInput("CustomPredictedSites", label = "Upload pre-identifed TFBS", value = TRUE),
               conditionalPanel(
                 condition = "input.CustomPredictedSites == true",
                 fileInput("CustomPredictedSitesGenomicSites", "Upload bed file format of the predicted sites", multiple = FALSE)),
               
               
               h4("Cis Regulatory module Options"),
               checkboxInput("CustomPromoterLengths", label = "Advanced Cis Regulatory Module Options", value = FALSE),
               conditionalPanel(
                 condition = "input.CustomPromoterLengths == true",
               fluidRow(
                 #Promoter Option
               column(2, numericInput(inputId= "PromoterStart", label = "Promoter Start/
                            Upstream of TSS", value = 2000, min = 0, width = 100)),
               
               column(2,numericInput(inputId= "PromoterFinish", label = "Promoter End/
                            DownStream of TSS", value = 200, min = 0, width= 100)),
               # Enhancer Options
               column(6, 
                      sliderInput("correlationCutOff", "Minimum enhancer-promoter correlation score", 
                                  min = 0, max= 1, value = 0))
               )
               ),
                    
                    
                    
                    h4("Conservation Options"),
                    checkboxInput("Conserved", label = "Identify Motifs In Conserved Promoter regions", value = FALSE),
                    
                    
               h4("Epigenomic Environment"),
                    selectizeInput("CellTypeToPredict", label = "Cell Type/ Epigenomic Environment",choices = list("H1 Cell Line"="E003",
                                                                                                                   "H1 BMP4 Derived Mesendoderm Cultured Cells"="E004",
                                                                                                                   "H1 BMP4 Derived Trophoblast Cultured Cells"="E005",
                                                                                                                   "H1 Derived Mesenchymal Stem Cells"="E006",
                                                                                                                   "H1 Derived Neuronal Progenitor Cultured Cells"="E007",
                                                                                                                   "H9 Cell Line"="E008",
                                                                                                                   "IMR90 fetal lung fibroblasts Cell Line"="E017",
                                                                                                                   "iPS DF 6.9 Cell Line"="E021",
                                                                                                                   "iPS DF 19.11 Cell Line"="E022",
                                                                                                                   "Breast variant Human Mammary Epithelial Cells (vHMEC)"="E028",
                                                                                                                   "Primary monocytes from peripheral blood"="E029",
                                                                                                                   "Primary B cells from peripheral blood"="E032",
                                                                                                                   "Primary T cells from cord blood"="E033",
                                                                                                                   "Primary T cells from peripheral blood"="E034",
                                                                                                                   "Primary Natural Killer cells from peripheral blood"="E046",
                                                                                                                   "Primary hematopoietic stem cells G-CSF-mobilized Female"="E050",
                                                                                                                   "Primary hematopoietic stem cells G-CSF-mobilized Male"="E051",
                                                                                                                   "Foreskin Fibroblast Primary Cells skin01"="E055",
                                                                                                                   "Foreskin Fibroblast Primary Cells skin02"="E056",
                                                                                                                   "Foreskin Keratinocyte Primary Cells skin02"="E057",
                                                                                                                   "Foreskin Melanocyte Primary Cells skin01"="E059",
                                                                                                                   "Fetal Adrenal Gland"="E080",
                                                                                                                   "Fetal Brain Male"="E081",
                                                                                                                   "Fetal Brain Female"="E082",
                                                                                                                   "Fetal Heart"="E083",
                                                                                                                   "Fetal Intestine Large"="E084",
                                                                                                                   "Fetal Intestine Small"="E085",
                                                                                                                   "Fetal Kidney"="E086",
                                                                                                                   "Fetal Lung"="E088",
                                                                                                                   "Fetal Muscle Trunk"="E089",
                                                                                                                   "Fetal Muscle Leg"="E090",
                                                                                                                   "Placenta"="E091",
                                                                                                                   "Fetal Stomach"="E092",
                                                                                                                   "Fetal Thymus"="E093",
                                                                                                                   "Gastric"="E094",
                                                                                                                   "Ovary"="E097",
                                                                                                                   "Pancreas"="E098",
                                                                                                                   "Psoas Muscle"="E100",
                                                                                                                   "Small Intestine"="E109",
                                                                                                                   "A549 EtOH 0.02pct Lung Carcinoma Cell Line"="E114",
                                                                                                                   "GM12878 Lymphoblastoid Cell Line"="E116",
                                                                                                                   "HeLa-S3 Cervical Carcinoma Cell Line"="E117",
                                                                                                                   "HepG2 Hepatocellular Carcinoma Cell Line"="E118",
                                                                                                                   "HMEC Mammary Epithelial Primary Cells"="E119",
                                                                                                                   "HSMM Skeletal Muscle Myoblasts Cell Line"="E120",
                                                                                                                   "HSMM cell derived Skeletal Muscle Myotubes Cell Line"="E121",
                                                                                                                   "HUVEC Umbilical Vein Endothelial Cells Cell Line"="E122",
                                                                                                                   "K562 Leukemia Cell Line"="E123",
                                                                                                                   "Monocytes-CD14+ RO01746 Cell Line"="E124",
                                                                                                                   "NH-A Astrocytes Cell Line"="E125",
                                                                                                                   "NHDF-Ad Adult Dermal Fibroblast Primary Cells"="E126",
                                                                                                                   "NHEK-Epidermal Keratinocyte Primary Cells"="E127",
                                                                                                                   "NHLF Lung Fibroblast Primary Cells"="E128",
                                                                                                                   "H9 Derived Neuronal Progenitor Cultured Cells"="E009",
                                                                                                                   "H9 Derived Neuron Cultured Cells"="E010",
                                                                                                                   "Dnd41 TCell Leukemia Cell Line"="E115",
                                                                                                                   "Osteoblast Primary Cells"="E129",
                                                                                                                   "hESC Derived CD184+ Endoderm Cultured Cells"="E011",
                                                                                                                   "hESC Derived CD56+ Ectoderm Cultured Cells"="E012",
                                                                                                                   "hESC Derived CD56+ Mesoderm Cultured Cells"="E013",
                                                                                                                   "HUES48 Cell Line"="E014",
                                                                                                                   "HUES6 Cell Line"="E015",
                                                                                                                   "HUES64 Cell Line"="E016",
                                                                                                                   "iPS-18 Cell Line"="E019",
                                                                                                                   "iPS-20b Cell Line"="E020",
                                                                                                                   "Bone Marrow Derived Cultured Mesenchymal Stem Cells"="E026",
                                                                                                                   "Primary T helper memory cells from peripheral blood 2"="E037",
                                                                                                                   "Primary T helper naive cells from peripheral blood"="E038",
                                                                                                                   "Primary T helper naive cells from peripheral blood"="E039",
                                                                                                                   "Primary T helper memory cells from peripheral blood 1"="E040",
                                                                                                                   "Primary T helper cells PMA-I stimulated"="E041",
                                                                                                                   "Primary T helper 17 cells PMA-I stimulated"="E042",
                                                                                                                   "Primary T helper cells from peripheral blood"="E043",
                                                                                                                   "Primary T regulatory cells from peripheral blood"="E044",
                                                                                                                   "Primary T cells effector/memory enriched from peripheral blood"="E045",
                                                                                                                   "Primary T killer naive cells from peripheral blood"="E047",
                                                                                                                   "Primary T killer memory cells from peripheral blood"="E048",
                                                                                                                   "Mesenchymal Stem Cell Derived Chondrocyte Cultured Cells"="E049",
                                                                                                                   "Foreskin Keratinocyte Primary Cells skin03"="E058",
                                                                                                                   "Foreskin Melanocyte Primary Cells skin03"="E061",
                                                                                                                   "Primary mononuclear cells from peripheral blood"="E062",
                                                                                                                   "Adipose Nuclei"="E063",
                                                                                                                   "Aorta"="E065",
                                                                                                                   "Liver"="E066",
                                                                                                                   "Brain Angular Gyrus"="E067",
                                                                                                                   "Brain Anterior Caudate"="E068",
                                                                                                                   "Brain Cingulate Gyrus"="E069",
                                                                                                                   "Brain Hippocampus Middle"="E071",
                                                                                                                   "Brain Inferior Temporal Lobe"="E072",
                                                                                                                   "Brain_Dorsolateral_Prefrontal_Cortex"="E073",
                                                                                                                   "Brain Substantia Nigra"="E074",
                                                                                                                   "Colonic Mucosa"="E075",
                                                                                                                   "Colon Smooth Muscle"="E076",
                                                                                                                   "Duodenum Smooth Muscle"="E078",
                                                                                                                   "Esophagus"="E079",
                                                                                                                   "Pancreatic Islets"="E087",
                                                                                                                   "Left Ventricle"="E095",
                                                                                                                   "Lung"="E096",
                                                                                                                   "Placenta Amnion"="E099",
                                                                                                                   "Rectal Mucosa Donor 29"="E101",
                                                                                                                   "Rectal Mucosa Donor 31"="E102",
                                                                                                                   "Rectal Smooth Muscle"="E103",
                                                                                                                   "Right Atrium"="E104",
                                                                                                                   "Right Ventricle"="E105",
                                                                                                                   "Sigmoid Colon"="E106",
                                                                                                                   "Skeletal Muscle Female"="E108",
                                                                                                                   "Stomach Smooth Muscle"="E111",
                                                                                                                   "Thymus"="E112",
                                                                                                                   "Spleen"="E113",
                                                                                                                   "ES-I3 Cell Line"="E001",
                                                                                                                   "ES-WA7 Cell Line"="E002",
                                                                                                                   "iPS-15b Cell Line"="E018",
                                                                                                                   "Mesenchymal Stem Cell Derived Adipocyte Cultured Cells"="E023",
                                                                                                                   "ES-UCSF4  Cell Line"="E024",
                                                                                                                   "Adipose Derived Mesenchymal Stem Cell Cultured Cells"="E025",
                                                                                                                   "Breast Myoepithelial Primary Cells"="E027",
                                                                                                                   "Primary neutrophils from peripheral blood"="E030",
                                                                                                                   "Primary B cells from cord blood"="E031",
                                                                                                                   "Primary hematopoietic stem cells"="E035",
                                                                                                                   "Primary hematopoietic stem cells short term culture"="E036",
                                                                                                                   "Muscle Satellite Cultured Cells"="E052",
                                                                                                                   "Cortex derived primary cultured neurospheres"="E053",
                                                                                                                   "Ganglion Eminence derived primary cultured neurospheres"="E054",
                                                                                                                   "Brain Germinal Matrix"="E070",
                                                                                                                   "Duodenum Mucosa"="E077",
                                                                                                                   "Skeletal Muscle Male"="E107",
                                                                                                                   "Stomach Mucosa"="E110"), multiple= FALSE, selected= "E009"),
               
               # Transcriptomic List
               h4("Transcriptomic Input"),
                    checkboxInput("DifferentialExpressedGenes", label = "Differentially expressed genes", value = FALSE),
                    conditionalPanel(
                      condition = "input.DifferentialExpressedGenes == true",
                      fileInput("differenitallyExpressedGenesList", "Upload differentially expressed gene symbol list", multiple = FALSE)),
               
               # Action button
                    actionButton("ComputeTranscriptionFactorSites", "Computationally Predict Sites"), 
                    width = 4, height = 900),
             
             box(title = "Position Weight Matrix", 
             fluidRow(withSpinner(plotOutput("VisualizeTFMotif", width="90%", height = 600),
                         type = getOption("spinner.type", default = 3),
                         color = getOption("spinner.color", default = "#0275D8"),
                         color.background = getOption("spinner.color.background", default = "#FFFFFF"))),
                 br(),
             h4("Downloads"),
             fluidRow(
               #Download buttons
                 column( 3 ,
                downloadButton('rawMotifPositions', 'Download all
                                                 TFBS'),
                
                downloadButton('RegualtoryModuleMotifs', 'Download TFBS 
                                         in CRMs'),
                
                downloadButton('returnObjectUnbaised', 'Download TFBS 
                                         in active regions'), 
                                  
                downloadButton('TranscriptomicFiltered', 'Download the 
                                          Transcriptomic TFBS')
),
               
                   column( 8 ,
                                    p("Download the unfiltered motifs or uploaded TFBS"), 
                                    
                                    p("Download the motifs/TFBS in CRMs"),
                                    
                                    p("Download the motifs/TFBS filtered for CRM and active chromatin states"), 
                                    
                                    p("Download the motifs/TFBS in CRM and active chromatin states regulating DE genes"))
                

                 ),
             collapsible = TRUE, width= 8, height = 900
             ),
             
  
             
             box(title = "Predicted TFBS ", width= 12, collapsible = TRUE,
             withSpinner(dataTableOutput("EnhancerTable"),
                         type = getOption("spinner.type", default = 3),
                         color = getOption("spinner.color", default = "#0275D8"),
                         color.background = getOption("spinner.color.background", default = "#FFFFFF")))),
    
    tabPanel("Genome Browser and Data Table",
             box(title= "Genome Browser Inputs", 
                 
                 numericInput("fromM", "Starting Base",value = 25016813),
                 
                 numericInput("toM", "Finishing Base", value = 25038065),
                 
                 selectInput("chrM", label = h4("Chromosome"),
                             
                             choices = list("Chromosome 1" = "chr1",
                                            "Chromosome 2" = "chr2",
                                            "Chromosome 3" = "chr3",
                                            "Chromosome 4" = "chr4",
                                            "Chromosome 5" = "chr5",
                                            "Chromosome 6" = "chr6",
                                            "Chromosome 7" = "chr7",
                                            "Chromosome 8" = "chr8",
                                            "Chromosome 9" = "chr9",
                                            "Chromosome 10" = "chr10",
                                            "Chromosome 11" = "chr11",
                                            "Chromosome 12" = "chr12",
                                            "Chromosome 13" = "chr13",
                                            "Chromosome 14" = "chr14",
                                            "Chromosome 15" = "chr15",
                                            "Chromosome 16" = "chr16",
                                            "Chromosome 17" = "chr17",
                                            "Chromosome 18" = "chr18",
                                            "Chromosome 19" = "chr19",
                                            "Chromosome 20" = "chr20",
                                            "Chromosome 21" = "chr21",
                                            "Chromosome 22" = "chr22",
                                            "Chromosome X" = "chrX",
                                            "Chromosome Y" = "chrY"), selected = "chrX"),
                 actionButton("GenomeBrowserAction", "Refresh Genome Browser"),
                 br(),
                 
                 # activate me later whne u get the server side running
                 # downloadButton('SaveHighResGVIZImage', 'Save high-res image of genome browser'),
                 # 
                 width = 3, height = 700),
             box( title = "Genome Browser", width = 9, collapsible = TRUE, height = 700,
             withSpinner(plotOutput("GenomeBrowser"),
                         type = getOption("spinner.type", default = 3),
                         color = getOption("spinner.color", default = "#0275D8"),
                         color.background = getOption("spinner.color.background", default = "#FFFFFF"))),
             
             box(title = "Legend for ChromHMM", collapsible = TRUE, width=3,
                 withSpinner(plotOutput("LegendsPlot"),
                             type = getOption("spinner.type", default = 3),
                             color = getOption("spinner.color", default = "#0275D8"),
                             color.background = getOption("spinner.color.background", default = "#FFFFFF"))),
             box( title = "TFBS shown in browser", collapsible = TRUE, width = 9,
             tabsetPanel(
             tabPanel("Multi-omic filtered TFBS",
             withSpinner(dataTableOutput("DataTablePredictedSites"),
                         type = getOption("spinner.type", default = 3),
                         color = getOption("spinner.color", default = "#0275D8"),
                         color.background = getOption("spinner.color.background", default = "#FFFFFF"))),
             tabPanel("Raw/ Non filtered TFBS",
               withSpinner(dataTableOutput("DataTableRawSites"),
                         type = getOption("spinner.type", default = 3),
                         color = getOption("spinner.color", default = "#0275D8"),
                         color.background = getOption("spinner.color.background", default = "#FFFFFF")))))
             
             ),
             

    
    tabPanel("Gene Ontology",
             box( 
           
                 
                 actionButton("GeneOntology", "Re-compute Gene Ontology Results"),
                 h4("Click me if the transcription Factor or Cell type changes."),
                 selectInput("OntologyType", "Gene Ontology Type", list("Molecular Function" = "MF",
                                                                        "Biological Processes" = "BP",
                                                                        "Cellular Component" = "CC"), 
                             selected = "BP", 
                             multiple = TRUE,
                             selectize = TRUE),
                 sliderInput("GeneOntologyPValueCutOff", "Adjusted P value Cut off", min = 0, max= 1, value = 0.05),
                 sliderInput("GeneOntologyRawPvalue", "P value Cut off", min = 0, max= 1, value = 0.05),
                 numericInput("GeneOntologyNumeric", label = "Minimum Number of DE genes in Term", value = 0),
                 
                 width= 3, height= 600),
             
             
             box( title = "Gene Ontology Results", width = 9,
             withSpinner(dataTableOutput("GeneOntologyTableResults"),
                         type = getOption("spinner.type", default = 3),
                         color = getOption("spinner.color", default = "#0275D8"),
                         color.background = getOption("spinner.color.background", default = "#FFFFFF"))), height= 600)
    
            
  )
    
    )
)
